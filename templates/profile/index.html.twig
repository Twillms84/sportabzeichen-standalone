{% extends 'base.html.twig' %}

{% block title %}Mein Konto{% endblock %}


{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('styles/profile.css') }}">
{% endblock %}

{% block body %}
<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8" 
             data-controller="password-validator"> {# Stimulus Controller Name #}
            
            <div class="card shadow-sm border-0">
                <div class="card-header bg-primary text-white py-3">
                    <h5 class="mb-0"><i class="fas fa-user-circle me-2"></i>Mein Konto</h5>
                </div>
                
                <div class="card-body p-4 text-body">
                    {{ form_start(form) }}
                        <div class="row">
                            <div class="col-md-6 mb-3">{{ form_row(form.firstname) }}</div>
                            <div class="col-md-6 mb-3">{{ form_row(form.lastname) }}</div>
                        </div>
                        <div class="mb-2">{{ form_row(form.email) }}</div>
                        <p class="text-muted small mb-4">
                            <i class="fas fa-info-circle me-1"></i> Stammdaten sind schreibgeschützt.
                        </p>

                        {% if form.examinerId is defined %}
                            <div class="mb-4">{{ form_row(form.examinerId) }}</div>
                        {% endif %}

                        <hr class="my-4">
                        
                        {# Anforderungen mit data-target #}
                        <div class="alert alert-secondary border-0 shadow-sm small mb-4 text-body">
                            <strong>Passwort-Check:</strong>
                            <ul class="list-unstyled mb-0 mt-2">
                                <li data-password-validator-target="requirement" data-pw-requirement="length" class="mb-1">
                                    <i class="fas fa-circle me-2 font-xs"></i>Mind. 8 Zeichen
                                </li>
                                <li data-password-validator-target="requirement" data-pw-requirement="upper" class="mb-1">
                                    <i class="fas fa-circle me-2 font-xs"></i>Groß- & Kleinbuchstaben
                                </li>
                                <li data-password-validator-target="requirement" data-pw-requirement="number" class="mb-1">
                                    <i class="fas fa-circle me-2 font-xs"></i>Mind. eine Zahl
                                </li>
                                <li data-password-validator-target="requirement" data-pw-requirement="special" class="mb-1">
                                    <i class="fas fa-circle me-2 font-xs"></i>Ein Sonderzeichen
                                </li>
                                <li data-password-validator-target="requirement" data-pw-requirement="match" class="mt-2 pt-2 border-top">
                                    <i class="fas fa-circle me-2 font-xs"></i>Passwörter identisch
                                </li>
                            </ul>
                        </div>

                        <div class="bg-body-tertiary p-3 rounded border mb-4 shadow-sm">
                            {% if form.currentPassword is defined %}
                                <div class="mb-3">{{ form_row(form.currentPassword) }}</div>
                                <hr class="opacity-10">
                            {% endif %}
                            
                            <div class="row">
                                <div class="col-md-6">
                                    {{ form_row(form.plainPassword.first, {
                                        'attr': {
                                            'data-password-validator-target': 'first',
                                            'data-action': 'input->password-validator#validate'
                                        }
                                    }) }}
                                </div>
                                <div class="col-md-6">
                                    {{ form_row(form.plainPassword.second, {
                                        'attr': {
                                            'data-password-validator-target': 'second',
                                            'data-action': 'input->password-validator#validate'
                                        }
                                    }) }}
                                </div>
                            </div>
                        </div>

                        <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                            <button type="submit" class="btn btn-success px-5">Speichern</button>
                        </div>
                    {{ form_end(form) }}
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}