{# templates/admin/participants/print_codes.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}QR-Zugangscodes drucken{% endblock %}

{% block body %}
<div class="container mt-4 d-print-none">
    <button onclick="window.print();" class="btn btn-primary mb-4">
        <i class="bi bi-printer"></i> Diese Seite drucken
    </button>
</div>

<div class="print-grid">
    {% for participant in participants %}
        {% set user = participant.user %}
        {% if user.loginToken %}
            <div class="access-card">
                <h3 style="font-size: 1.1rem; margin-bottom: 5px;">Sportabzeichen-Zugang</h3>
                <p><strong>{{ user.firstname }} {{ user.lastname }}</strong></p>
                
                {# QR-Code via Google Charts API - Nutzt unsere neue Route #}
                <img src="https://chart.googleapis.com/chart?chs=180x180&cht=qr&chl={{ url('app_login_by_token', {token: user.loginToken})|url_encode }}&choe=UTF-8" alt="QR Code">
                
                <p><small>Scannen zum Einloggen & Ergebnisse sehen</small></p>
                <p class="url" style="font-size: 0.6rem; color: #666;">{{ url('app_login_by_token', {token: user.loginToken}) }}</p>
            </div>
        {% endif %}
    {% endfor %}
</div>

<style>
    .print-grid { display: flex; flex-wrap: wrap; justify-content: flex-start; }
    .access-card { 
        border: 1px solid #ddd; 
        padding: 15px; 
        margin: 10px; 
        width: 250px; 
        text-align: center; 
        border-radius: 10px;
        background: white;
    }
    @media print {
        .d-print-none { display: none !important; }
        .access-card { page-break-inside: avoid; border: 1px solid #000; }
        body { background: white; }
    }
</style>
{% endblock %}